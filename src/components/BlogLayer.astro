---
import ColumnList from '../components/ColumnList';
import ColumnCard from '../components/ColumnCard';
import Layout from '../layouts/Layout.astro'
import { newtClient } from '../lib/newt'
import type { Article } from '../lib/newt'
import BtnA from "../components/BtnA";

const { items: articles } = await newtClient.getContents<Article>({
  appUid: 'blog',
  modelUid: 'article',
    query: {
      limit: 6,
    },
})
---

<section id="blogLayer" class="layer">
  <div class="layer__content">
    <div class="layer__heading">
      <svg id="_レイヤー_1" data-name="レイヤー 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128.14 64.97">
        <path class="blog-path" d="M0,0H14.77c4.66,0,8.2,.36,10.6,1.09,2.4,.73,4.34,2.2,5.82,4.41,1.48,2.21,2.21,5.78,2.21,10.7,0,3.33-.52,5.64-1.56,6.96-1.04,1.31-3.1,2.32-6.17,3.02,3.42,.77,5.74,2.06,6.96,3.85,1.22,1.79,1.83,4.54,1.83,8.25v5.28c0,3.85-.44,6.7-1.32,8.55-.88,1.85-2.28,3.12-4.2,3.8-1.92,.68-5.86,1.02-11.81,1.02H0V0ZM14.8,9.74v12.66c.63-.02,1.12-.04,1.48-.04,1.45,0,2.38-.36,2.78-1.07,.4-.71,.6-2.76,.6-6.13,0-1.78-.16-3.03-.49-3.74-.33-.71-.76-1.17-1.28-1.35-.53-.19-1.55-.29-3.08-.32Zm0,21.52v15.93c2.09-.07,3.42-.4,3.99-.98,.57-.59,.86-2.03,.86-4.32v-5.31c0-2.44-.26-3.91-.77-4.43-.52-.52-1.88-.81-4.08-.88Z"/>
        <path class="blog-path" d="M53.96,0V56.92h-14.62V0h14.62Z"/>
        <path class="blog-path" d="M91.2,26.65v11.43c0,4.2-.21,7.27-.63,9.23-.42,1.96-1.32,3.79-2.71,5.48-1.38,1.7-3.16,2.95-5.33,3.76-2.17,.81-4.66,1.21-7.47,1.21-3.14,0-5.8-.35-7.98-1.04s-3.87-1.73-5.08-3.13c-1.21-1.39-2.07-3.08-2.58-5.06-.52-1.98-.77-4.95-.77-8.91v-11.95c0-4.34,.47-7.72,1.41-10.16,.94-2.44,2.62-4.39,5.06-5.87,2.44-1.48,5.55-2.21,9.35-2.21,3.19,0,5.92,.47,8.21,1.42s4.05,2.19,5.29,3.71c1.24,1.52,2.09,3.09,2.55,4.71s.69,4.08,.69,7.38Zm-14.2-3.52c0-2.39-.13-3.9-.39-4.52-.26-.62-.81-.93-1.65-.93s-1.41,.31-1.69,.93c-.28,.62-.42,2.13-.42,4.52v21.06c0,2.2,.14,3.64,.42,4.31s.83,1,1.65,1,1.4-.3,1.67-.91c.27-.61,.4-1.92,.4-3.94V23.13Z"/>
        <path class="blog-path" d="M128.14,10.27V46.2c0,4.85-.11,7.99-.33,9.4-.22,1.42-1.01,2.92-2.37,4.5-1.36,1.58-3.25,2.79-5.68,3.62s-5.48,1.25-9.16,1.25c-4.52,0-8.16-.77-10.9-2.3s-4.16-4.55-4.25-9.05h13.78c0,2.06,.75,3.09,2.25,3.09,1.08,0,1.79-.32,2.14-.95s.53-1.96,.53-3.98v-3.52c-1.22,1.1-2.5,1.94-3.85,2.5-1.35,.56-2.76,.85-4.24,.85-2.55,0-4.66-.52-6.31-1.55-1.65-1.03-2.78-2.38-3.39-4.06-.61-1.68-.91-4.06-.91-7.15V21.9c0-4.43,.8-7.62,2.39-9.56,1.59-1.95,4.02-2.92,7.28-2.92,1.78,0,3.4,.36,4.87,1.09,1.46,.73,2.77,1.82,3.92,3.28l1.02-3.52h13.22Zm-14.24,12.38c0-2.13-.12-3.49-.37-4.08-.25-.59-.79-.88-1.63-.88s-1.4,.33-1.74,1c-.34,.67-.51,1.99-.51,3.96v15.68c0,2.09,.13,3.44,.39,4.06,.26,.62,.8,.93,1.62,.93,.94,0,1.55-.37,1.83-1.12,.28-.75,.42-2.45,.42-5.1v-14.45Z"/>
      </svg>
    </div>

    <div class="blog">
      <p class="blog__ttl">
        <span>Blog</span>
      </p>
      <div class="blog__content">
        <div class="l-section">
          <div class="lcolumn__contentl-inner">
            <div class="u-mb-m">
            </div>	
            <!-- <ColumnList data={articles} client:load /> -->
            
            <ul class="column__content js-column">
							{articles.map((item) => (
								<li class="column__card">
									<ColumnCard data={item} />
								</li>
							))}
						</ul>

            <div class="u-align-c column__btn">
              <BtnA text="All View" href="/blog/" />
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
  <div id="blogClose" class="layer__close">
    <svg id="_レイヤー_1" data-name="レイヤー 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 145.83 145.83">
      <circle cx="72.92" cy="72.92" r="70.42" fill="#ff9326" stroke="#000" stroke-miterlimit="10" stroke-width="5px"/>
      <g>
        <line x1="110.92" y1="34.91" x2="34.91" y2="110.92" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="5px"/>
        <line x1="36.68" y1="36.68" x2="109.16" y2="109.16" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="5px"/>
      </g>
    </svg>
  </div>
</section>

<style lang="scss">
  @import '../styles/vars.scss';

  .layer {
    height: 100vh;
    width: 100%;
    position: fixed;
    background: rgba(0, 0, 0, 0.3);
    z-index: -2;
    opacity: 0;
    transition: 0.5s;
    overflow-y: auto;
    
    &__content {
      transition: 0.5s;
      background: #ff9326;
      padding: 0 vw-pc(80) vw-pc(200);
      min-height: 100vh;
      width:85%;
      margin-left: auto;
      position: absolute;
      top: 0;
      right: -100%;
      overflow: visible;

      @include max-screen($bp-sp) {
        width: 100%;
      }
      
    }

    &__heading {
      height: 100vh;
      display: flex;
      align-items: center;
      svg {
        height: vw-pc(300);
      }
    }

    &__close {
      position: fixed;
      top: 50%;
      left: -100%;
      transform: translateY(-50%);
      width: vw-pc(150);
      height: vw-pc(150);
      transition: 0.3s;
      cursor: pointer;

      @include max-screen($bp-sp) {
        width: 4rem;
        height: 4rem;
        top: 2rem;
        left: 2rem;
        transform: translateY(0);
      }

      &:hover {
        transform: translateY(-50%) rotate(90deg);
      }
    }

    &.active {
      opacity: 1;
      z-index: 1000;


      .layer__content {
        right: 0;
      }

      .layer__close {
        left: vw-pc(40);
      }
    }

    
  }

  .blog {
    // display: flex;
    justify-content: space-between;
    &__ttl {
      width: 30%;
      margin-bottom: vw-pc(100);
      span {
        font-size: vw-pc(80);
        font-family: "Barlow", sans-serif;
        font-weight: 900;
        text-align: right;
        border-bottom: 2px solid #000;
        padding-bottom: vw-pc(30);

      }
    }

    &__top {
      display: flex;
      align-items: center;
      margin-bottom: vw-pc(60);
    }

    &__img {
      width: vw-pc(200);
      height: vw-pc(200);
      overflow: hidden;
      border-radius: 50%;
      margin-right: vw-pc(40);
      img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
    }

    &__name {
      font-size: vw-pc(60);
      line-height: 1.5;
    }

    &__name-en {
      font-family: "Barlow", sans-serif;
    }

    &__name-ja {
      font-size: vw-pc(30);
    }

    &__content {
      font-size: vw-pc(30);
      line-height: 2;
      font-weight: 500;
      width: 100%;
    }

    &__ja {
      margin-bottom: vw-pc(50);
    }
    &__en {
      line-height: 1.5;
      font-size: vw-pc(25);
      margin-bottom: vw-pc(60);
    }
  }

  .column__content {
    margin-top: vw-pc(80);
    margin-bottom: vw-pc(80);
    display: flex;
    gap: vw-pc(50);
    flex-wrap: wrap;
    @include max-screen($bp-sp) {
      margin-top: 2.5rem;
      margin-bottom: 2.5rem;
    }
  }

  .column__card {
    width: calc((100% - vw-pc(50)) / 2);
  }

  .blog-list {
    display: flex;
    justify-content: space-between;
    gap: vw-pc(30);

    li {
      width: calc((100% - vw-pc(30)) * 1 / 3);
      background: #fff;
      border-radius: 5px;
      padding-bottom: vw-pc(20);
      overflow: hidden;
    }

    &__img {
      margin-bottom: vw-pc(20);
    }

    &__ttl {
      font-weight: bold;
      font-size: vw-pc(20);
      margin: 0 10px;
    }

    &__text {
      font-size: vw-pc(20);
      margin: 0 10px;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const layer = document.querySelector('#blogLayer');
    const close = document.querySelector('#blogClose');

    close.addEventListener('click', () => {
      layer.classList.remove('active');
      document.body.classList.remove('no-scroll');
    });
  });
</script>